<script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js" ></script>
<script type="text/javascript" src="https://cdn.iamport.kr/js/iamport.payment-1.1.5.js"></script>


<html>
    <head>

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

        <h1>
            test page
        </h1>
    </head>
    <body>
        <form name="myform3" method="post" action="/auth/loginProc">
            <input type="text" name="username">
            <input type="password" name="password">
            <input type="submit">
        </form>
        <form name="myform" method="post" enctype="multipart/form-data" action="/certificate">
            <input type="file" name="file">
            <input type="submit">
        </form>

        <form name="myform2" method="post" enctype="multipart/form-data" action="/upload">
            <input type="file" name="file">
            <input type="submit">
        </form>

        <img src="/getProfile?userid=8" width-="300px" height="100px"/>


        <form name="myform2" method="post" enctype="multipart/form-data" action="/signup/mentee">

            <input type="text" name="username">
            <input type="password" name="password">
            <input type="email" name="email">
            <input type="password" name="nickname">
            <input type="file" name="profile">
            <input type="submit">
        </form>

        

        <form name="myform4" method="post" action="/board/write">
            <input type="text" name="title">
            <input type="text" name="content">
            <input type="submit">
        </form>

        
        <body>
            <h1>상품 목록</h1>
            <div class="itemSection">
                <div class="itemCard">
                    <div class="itemTitle">
                        <h1>블루투스 노이즈캔슬링 헤드폰</h1>
                    </div>
                    <div class="itemContent">
                        <h2>스튜디오 원음에 가까운 고품질 사운드</h2>
                    </div>
                    <div class="itemPrice">
                        <!-- 금액은 dataset에 작성 -->
                        <p data-price="100">$100</p>
                    </div>
                    <div class="itemButton">
                        <button class="orderBtn">주문하기</button>
                    </div>
                </div>
                <div class="itemCard">
                    <div class="itemTitle">
                        <h1>저소음 적축 키보드</h1>
                    </div>
                    <div class="itemContent">
                        <h2>키보드 내부 흡음패드를 장착</h2>
                    </div>
                    <div class="itemPrice">
                        <p data-price="200">$200</p>
                    </div>
                    <div class="itemButton">
                        <button class="orderBtn">주문하기</button>
                    </div>
                </div>
                <div class="itemCard">
                    <div class="itemTitle">
                        <h1>49인치 게이밍 모니터</h1>
                    </div>
                    <div class="itemContent">
                        <h2>퀀텀 매트릭스 기술로 완성한 궁극의 화질</h2>
                    </div>
                    <div class="itemPrice">
                        <p data-price="300">$300</p>
                    </div>
                    <div class="itemButton">
                        <button class="orderBtn">주문하기</button>
                    </div>
                </div>
            </div>
        </body>
        <script>
            var merchant_uid = "";
            var name = "";
            var amount = 0;
            
            // click 이벤트
            $(".itemSection").on("click", ".orderBtn", function(){
                // 서로 다른 결제건에 주문번호가 중복되지 않도록 주문번호에 현재시간 정보를 넣어줌
                d = new Date();
                merchant_uid = "order" + d.getTime();
                name = $(this).parent().siblings(".itemTitle").children().text();
                amount = $(this).parent().siblings(".itemPrice").children().attr("data-price");
                iamport();
            });
        
            IMP.init('imp58512310');
            function iamport(){
                // IMP.request_pay(param, callback) 결제창 호출
                IMP.request_pay({ // param
                // KG이니시스
                pg : 'html5_inicis',
                // 결제수단
                pay_method : 'card',
                // 상품에서 관리하는 주문번호를 전달 - 바뀌어야됨
                merchant_uid : merchant_uid,
                // 결제창에 삽입할 상품명 - 바뀌어야됨
                name : name,
                // 금액 - 바뀌어야됨
                amount : amount,
                // 구매자 이메일
                buyer_email : 'iamport@siot.do',
                // 구매자 번호
                buyer_tel : '010-1234-5678',
                // 구매자 주소
                buyer_addr : '서울특별시 강남구 삼성동',
                // 구매자 우편번호
                buyer_postcode : '12345',
            }, function(rsp){ // callback
                    // 결제 성공시 처리할 내역
                    if(rsp.success){
                        var msg = '결제가 완료되었습니다.\n';
                        msg += '고유 ID: ' + rsp.imp_uid + '\n';
                        msg += '상점 거래 ID: ' + rsp.merchant_uid + '\n';
                        msg += '결제 금액: ' + rsp.paid_amount + '\n';
                        msg += '카드 승인번호: ' + rsp.apply_num;
                        // 결제 실패시 처리할 내역
                    }else{
                        var msg = '결제에 실패했습니다.\n';
                        msg += '에러내용: ' + rsp.error_msg;
                    }
                    alert(msg);
                });
            }
        </script>
</html>